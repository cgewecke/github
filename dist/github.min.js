(function(){var t,n;"undefined"!=typeof exports?(t=require("xmlhttprequest").XMLHttpRequest,n=require("underscore"),btoa=require("btoa")):n=window._,"undefined"!=typeof window&&"undefined"!=typeof window.XMLHttpRequest&&(t=window.XMLHttpRequest);var e="https://api.github.com",i=function(o){function s(n,i,s,u,r,c){function f(){var t=i.indexOf("//")>=0?i:e+i;return t+(/\?/.test(t)?"&":"?")+(new Date).getTime()}var l=new t;if(r||(l.dataType="json"),l.open(n,f(),!c),c||(l.onreadystatechange=function(){4==this.readyState&&(this.status>=200&&this.status<300||304===this.status?u(null,r?this.responseText:this.responseText?JSON.parse(this.responseText):!0,this):u({path:i,request:this,error:this.status}))}),l.setRequestHeader("Accept","application/vnd.github.v3.raw+json"),l.setRequestHeader("Content-Type","application/json;charset=UTF-8"),o.token||o.username&&o.password){var a=o.token?"token "+o.token:"Basic "+btoa(o.username+":"+o.password);l.setRequestHeader("Authorization",a)}return s?l.send(JSON.stringify(s)):l.send(),c?l.response:void 0}function u(t,e){var i=[];!function o(){s("GET",t,null,function(s,u,r){if(s)return e(s);i.push.apply(i,u);var c=(r.getResponseHeader("link")||"").split(/\s*,\s*/g),f=n.find(c,function(t){return/rel="next"/.test(t)});f&&(f=(/<(.*)>/.exec(f)||[])[1]),f?(t=f,o()):e(s,i)})}()}i.User=function(){this.repos=function(t){u("/user/repos?type=all&per_page=1000&sort=updated",function(n,e){t(n,e)})},this.orgs=function(t){s("GET","/user/orgs",null,function(n,e){t(n,e)})},this.gists=function(t){s("GET","/gists",null,function(n,e){t(n,e)})},this.notifications=function(t){s("GET","/notifications",null,function(n,e){t(n,e)})},this.show=function(t,n){var e=t?"/users/"+t:"/user";s("GET",e,null,function(t,e){n(t,e)})},this.userRepos=function(t,n){u("/users/"+t+"/repos?type=all&per_page=1000&sort=updated",function(t,e){n(t,e)})},this.userEvents=function(t,n){var e="/users/"+t+"/events/public";s("GET",e,null,function(t,e){n(t,e)})},this.userFollowers=function(t,n){var e="/users/"+t+"/followers";s("GET",e,null,function(t,e){n(t,e)})},this.userGists=function(t,n){s("GET","/users/"+t+"/gists",null,function(t,e){n(t,e)})},this.orgRepos=function(t,n){u("/orgs/"+t+"/repos?type=all&&page_num=1000&sort=updated&direction=desc",function(t,e){n(t,e)})},this.follow=function(t,n){s("PUT","/user/following/"+t,null,function(t,e){n(t,e)})},this.unfollow=function(t,n){s("DELETE","/user/following/"+t,null,function(t,e){n(t,e)})}},i.Repository=function(t){function e(t,n){return t===f.branch&&f.sha?n(null,f.sha):void r.getRef("heads/"+t,function(e,i){f.branch=t,f.sha=i,n(e,i)})}var o=t.name,u=t.user,r=this,c="/repos/"+u+"/"+o,f={branch:null,sha:null};this.getRef=function(t,n){s("GET",c+"/git/refs/"+t,null,function(t,e){return t?n(t):void n(null,e.object.sha)})},this.createRef=function(t,n){s("POST",c+"/git/refs",t,n)},this.deleteRef=function(n,e){s("DELETE",c+"/git/refs/"+n,t,e)},this.createRepo=function(t,n){s("POST","/user/repos",t,n)},this.deleteRepo=function(n){s("DELETE",c,t,n)},this.listTags=function(t){s("GET",c+"/tags",null,function(n,e){return n?t(n):void t(null,e)})},this.listPulls=function(t,n){s("GET",c+"/pulls"+(t?"?state="+t:""),null,function(t,e){return t?n(t):void n(null,e)})},this.getPull=function(t,n){s("GET",c+"/pulls/"+t,null,function(t,e){return t?n(t):void n(null,e)})},this.compare=function(t,n,e){s("GET",c+"/compare/"+t+"..."+n,null,function(t,n){return t?e(t):void e(null,n)})},this.listBranches=function(t){s("GET",c+"/git/refs/heads",null,function(e,i){return e?t(e):void t(null,n.map(i,function(t){return n.last(t.ref.split("/"))}))})},this.getBlob=function(t,n){s("GET",c+"/git/blobs/"+t,null,n,"raw")},this.getSha=function(t,e,i){return""===e?r.getRef("heads/"+t,i):void r.getTree(t+"?recursive=true",function(t,o){if(t)return i(t);var s=n.select(o,function(t){return t.path===e})[0];i(null,s?s.sha:null)})},this.getTree=function(t,n){s("GET",c+"/git/trees/"+t,null,function(t,e){return t?n(t):void n(null,e.tree)})},this.postBlob=function(t,n){t="string"==typeof t?{content:t,encoding:"utf-8"}:{content:btoa(String.fromCharCode.apply(null,new Uint8Array(t))),encoding:"base64"},s("POST",c+"/git/blobs",t,function(t,e){return t?n(t):void n(null,e.sha)})},this.updateTree=function(t,n,e,i){var o={base_tree:t,tree:[{path:n,mode:"100644",type:"blob",sha:e}]};s("POST",c+"/git/trees",o,function(t,n){return t?i(t):void i(null,n.sha)})},this.postTree=function(t,n){s("POST",c+"/git/trees",{tree:t},function(t,e){return t?n(t):void n(null,e.sha)})},this.commit=function(n,e,o,u){var r=new i.User;r.show(null,function(i,r){if(i)return u(i);var l={message:o,author:{name:t.user,email:r.email},parents:[n],tree:e};s("POST",c+"/git/commits",l,function(t,n){return t?u(t):(f.sha=n.sha,void u(null,n.sha))})})},this.updateHead=function(t,n,e){s("PATCH",c+"/git/refs/heads/"+t,{sha:n},function(t,n){e(t)})},this.show=function(t){s("GET",c,null,t)},this.contents=function(t,n,e,i){return s("GET",c+"/contents?ref="+t+(n?"&path="+n:""),null,e,"raw",i)},this.fork=function(t){s("POST",c+"/forks",null,t)},this.branch=function(t,n,e){2===arguments.length&&"function"==typeof arguments[1]&&(e=n,n=t,t="master"),this.getRef("heads/"+t,function(t,i){return t&&e?e(t):void r.createRef({ref:"refs/heads/"+n,sha:i},e)})},this.createPullRequest=function(t,n){s("POST",c+"/pulls",t,n)},this.listHooks=function(t){s("GET",c+"/hooks",null,t)},this.getHook=function(t,n){s("GET",c+"/hooks/"+t,null,n)},this.createHook=function(t,n){s("POST",c+"/hooks",t,n)},this.editHook=function(t,n,e){s("PATCH",c+"/hooks/"+t,n,e)},this.deleteHook=function(t,n){s("DELETE",c+"/hooks/"+t,null,n)},this.read=function(t,n,e){r.getSha(t,n,function(t,n){return n?void r.getBlob(n,function(t,i){e(t,i,n)}):e("not found",null)})},this.remove=function(t,i,o){e(t,function(e,s){r.getTree(s+"?recursive=true",function(e,u){var c=n.reject(u,function(t){return t.path===i});n.each(c,function(t){"tree"===t.type&&delete t.sha}),r.postTree(c,function(n,e){r.commit(s,e,"Deleted "+i,function(n,e){r.updateHead(t,e,function(t){o(t)})})})})})},this["delete"]=function(t,n,e){r.getSha(t,n,function(t,i){if(!i)return e("not found",null);var o=c+"/contents/"+n,u={message:"Deleted "+n,sha:i};o+="?message="+encodeURIComponent(u.message),o+="&sha="+encodeURIComponent(u.sha),s("DELETE",o,null,e)})},this.move=function(t,i,o,s){e(t,function(e,u){r.getTree(u+"?recursive=true",function(e,c){n.each(c,function(t){t.path===i&&(t.path=o),"tree"===t.type&&delete t.sha}),r.postTree(c,function(n,e){r.commit(u,e,"Deleted "+i,function(n,e){r.updateHead(t,e,function(t){s(t)})})})})})},this.write=function(t,n,i,o,s){e(t,function(e,u){return e?s(e):void r.postBlob(i,function(e,i){return e?s(e):void r.updateTree(u,n,i,function(n,e){return n?s(n):void r.commit(u,e,o,function(n,e){return n?s(n):void r.updateHead(t,e,s)})})})})},this.getCommits=function(t,n){t=t||{};var e=c+"/commits",i=[];if(t.sha&&i.push("sha="+encodeURIComponent(t.sha)),t.path&&i.push("path="+encodeURIComponent(t.path)),t.since){var o=t.since;o.constructor===Date&&(o=o.toISOString()),i.push("since="+encodeURIComponent(o))}if(t.until){var u=t.until;u.constructor===Date&&(u=u.toISOString()),i.push("until="+encodeURIComponent(u))}i.length>0&&(e+="?"+i.join("&")),s("GET",e,null,n)}},i.Gist=function(t){var n=t.id,e="/gists/"+n;this.read=function(t){s("GET",e,null,function(n,e){t(n,e)})},this.create=function(t,n){s("POST","/gists",t,n)},this["delete"]=function(t){s("DELETE",e,null,function(n,e){t(n,e)})},this.fork=function(t){s("POST",e+"/fork",null,function(n,e){t(n,e)})},this.update=function(t,n){s("PATCH",e,t,function(t,e){n(t,e)})},this.star=function(t){s("PUT",e+"/star",null,function(n,e){t(n,e)})},this.unstar=function(t){s("DELETE",e+"/star",null,function(n,e){t(n,e)})},this.isStarred=function(t){s("GET",e+"/star",null,function(n,e){t(n,e)})}},i.Issue=function(t){var n="/repos/"+t.user+"/"+t.repo+"/issues";this.list=function(t,e){s("GET",n,t,e)}},this.getIssues=function(t,n){return new i.Issue({user:t,repo:n})},this.getRepo=function(t,n){return new i.Repository({user:t,name:n})},this.getUser=function(){return new i.User},this.getGist=function(t){return new i.Gist({id:t})}};"undefined"!=typeof exports?module.exports=i:window.Github=i}).call(this);
//# sourceMappingURL=github.min.js.map
